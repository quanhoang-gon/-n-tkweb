<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ph√¢n ca nh√¢n vi√™n</title>
  <style>
    .container { display: flex; width: 100%; }
    .left { flex: 0 0 40%; background: pink; padding: 10px; }
    .right { flex: 0 0 60%; background: pink; padding: 10px; }
    .lich { flex: 1; background-color: white; color:black; border-radius: 4px; overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; text-align: center; border: 2px solid #000; }
    th, td { border: 1.5px solid #000; padding: 10px; font-size: 18px; }
    .title { text-align: center; }
  </style>
</head>
<body>
<div class="container">
  <div class="left">
    <h2>NH√ÇN VI√äN V√Ä CA L√ÄM</h2>
    <input type="text" id="search" placeholder="üîç search"><br>

    <div>
      <h3 onclick="hienThi('ql')">Qu·∫£n L√Ω ‚ñº</h3>
      <ul id="ql" style="display:none;"></ul>
    </div>

    <div>
      <h3 onclick="hienThi('pv')">Ph·ª•c V·ª• ‚ñº</h3>
      <ul id="pv" style="display:none;"></ul>
    </div>

    <div>
      <h3 onclick="hienThi('tn')">Thu Ng√¢n ‚ñº</h3>
      <ul id="tn" style="display:none;"></ul>
    </div>

    <button onclick="themNhanVien()">+ Th√™m nh√¢n vi√™n</button>
    <button id="xoaNV" onclick="xoaNhanVien()">- X√≥a nh√¢n vi√™n</button>
  </div>

  <div class="right">
    <h2 class="title" id="tenNV">Ch∆∞a ch·ªçn nh√¢n vi√™n</h2>
    <div class="lich">
      <table>
        <tr><th colspan="8" id="ngay"></th></tr>
        <tr>
          <th>Ca L√†m</th>
          <th>Th·ª© 2</th><th>Th·ª© 3</th><th>Th·ª© 4</th>
          <th>Th·ª© 5</th><th>Th·ª© 6</th><th>Th·ª© 7</th><th>CN</th>
        </tr>

        <tr id="rowSang">
          <td>S√°ng</td>
          <td id="sang2"></td><td id="sang3"></td><td id="sang4"></td>
          <td id="sang5"></td><td id="sang6"></td><td id="sang7"></td><td id="sangCN"></td>
        </tr>

        <tr id="rowChieu">
          <td>Chi·ªÅu</td>
          <td id="chieu2"></td><td id="chieu3"></td><td id="chieu4"></td>
          <td id="chieu5"></td><td id="chieu6"></td><td id="chieu7"></td><td id="chieuCN"></td>
        </tr>

        <tr id="rowToi">
          <td>T·ªëi</td>
          <td id="toi2"></td><td id="toi3"></td><td id="toi4"></td>
          <td id="toi5"></td><td id="toi6"></td><td id="toi7"></td><td id="toiCN"></td>
        </tr>
      </table>
    </div>

    <br>
    <button onclick="capNhat()">C·∫≠p nh·∫≠t</button>
    <button onclick="resetLuaChon()">Ch·ªçn l·∫°i</button>
  </div>
</div>

<script>
  let dsNV = JSON.parse(localStorage.getItem("dsNV")) || { ql: [], pv: [], tn: [] };
  let lichNV = JSON.parse(localStorage.getItem("lichNV")) || {};
let Xoa = false;        // L∆∞u l·ªãch c·ªßa t·ª´ng nh√¢n vi√™n
let nhanVienHienTai = ""; // Ai ƒëang ƒë∆∞·ª£c ch·ªçn

function hienThi(id) {
  var list = document.getElementById(id);
  list.style.display = (list.style.display === "none" || list.style.display === "") ? "block" : "none";
}

function themNhanVien() {
  var nhom = prompt("Th√™m v√†o nh√≥m n√†o? (ql/pv/tn): ");
  var ten = prompt("Nh·∫≠p t√™n nh√¢n vi√™n:");
  if (!ten) return;

  var list = document.getElementById(nhom);
  if (!list) { alert("Nh√≥m kh√¥ng h·ª£p l·ªá"); return; }

  var li = document.createElement("li");
  li.textContent = ten;

  li.onclick = function() {
    if (Xoa) {
      if (confirm("X√≥a nh√¢n vi√™n '" + ten + "'?")) this.remove();
    } else {
      chonNhanVien(ten);
    }
  };
  list.appendChild(li);
  alert("‚úÖ Th√™m nh√¢n vi√™n th√†nh c√¥ng.");


  lichNV[ten] = {};
  ids.forEach(id => lichNV[ten][id] = "Kh√¥ng");
}

function xoaNhanVien() {
  Xoa = !Xoa;
  var btn = document.getElementById("xoaNV");
  btn.textContent = Xoa ? "Ch·ªçn t√™n ƒë·ªÉ x√≥a" : "- X√≥a nh√¢n vi√™n";
}

const ids = [
  'sang2','sang3','sang4','sang5','sang6','sang7','sangCN',
  'chieu2','chieu3','chieu4','chieu5','chieu6','chieu7','chieuCN',
  'toi2','toi3','toi4','toi5','toi6','toi7','toiCN'
];

function taoRadio(id, giaTri = "Kh√¥ng") {
  var td = document.getElementById(id);
  td.innerHTML = `
    <label><input type="radio" name="${id}" value="C√≥" ${giaTri==="C√≥"?"checked":""}> C√≥</label>
    <label><input type="radio" name="${id}" value="Kh√¥ng" ${giaTri==="Kh√¥ng"?"checked":""}> Kh√¥ng</label>
  `;
}

function chonNhanVien(ten) {
  nhanVienHienTai = ten;
  document.getElementById("ngay").innerText = "L·ªãch l√†m c·ªßa: " + ten;

  if (!lichNV[ten]) {
    lichNV[ten] = {};
    ids.forEach(id => lichNV[ten][id] = "Kh√¥ng");
  }
  ids.forEach(id => {
    const val = lichNV[ten][id];
    const td = document.getElementById(id);
    td.textContent = (val === "C√≥") ? "‚úî" : "";
  });
  localStorage.setItem("lichNV", JSON.stringify(lichNV));
}

function capNhat() {
  if (!nhanVienHienTai) {
    alert("H√£y ch·ªçn nh√¢n vi√™n tr∆∞·ªõc!");
    return;
  }

  ids.forEach(id => {
    var cell = document.getElementById(id);
    var radios = cell.getElementsByTagName('input');
    var giaTri = lichNV[nhanVienHienTai][id] || "Kh√¥ng";
    for (var i = 0; i < radios.length; i++) {
      if (radios[i].checked) giaTri = radios[i].value;
    }

    lichNV[nhanVienHienTai][id] = giaTri;
    cell.textContent = (giaTri === "C√≥") ? "‚úî" : "";
  });

  alert("ƒê√£ l∆∞u l·ªãch cho " + nhanVienHienTai);
}

function resetLuaChon() {
  if (!nhanVienHienTai) {
    alert("‚ö†H√£y ch·ªçn nh√¢n vi√™n tr∆∞·ªõc!");
    return;
  }
  ids.forEach(id => taoRadio(id, lichNV[nhanVienHienTai][id]));
}

ids.forEach(id => taoRadio(id));

var today = new Date();
document.getElementById("ngay").innerText = "Th√°ng: " + (today.getMonth() + 1) + "/" + today.getFullYear();
</script>
</body>
</html>
